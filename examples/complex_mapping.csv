source_column,target_column,transformation,is_key
order_id,order_key,source_table.order_id,TRUE
customer_id,customer_key,source_table.customer_id,TRUE
order_date,order_timestamp,"TO_TIMESTAMP(source_table.order_date, 'YYYY-MM-DD')",FALSE
product_name,product_name_clean,"UPPER(TRIM(REGEXP_REPLACE(source_table.product_name, '[^a-zA-Z0-9 ]', '')))",FALSE
quantity,quantity,source_table.quantity,FALSE
unit_price,unit_price_decimal,"CAST(source_table.unit_price AS DECIMAL(10,2))",FALSE
discount_amount,discount_value,"COALESCE(source_table.discount_amount, 0)",FALSE
,total_amount,"(source_table.quantity * source_table.unit_price) - COALESCE(source_table.discount_amount, 0)",FALSE
order_status,status_description,"CASE WHEN source_table.order_status = 'N' THEN 'NEW' WHEN source_table.order_status = 'P' THEN 'PROCESSING' WHEN source_table.order_status = 'C' THEN 'COMPLETED' WHEN source_table.order_status = 'X' THEN 'CANCELLED' ELSE 'UNKNOWN' END",FALSE
shipping_address,full_address,"CONCAT_WS(', ', source_table.shipping_address, source_table.city, source_table.state, source_table.zip_code)",FALSE
created_by,created_by_user,LOWER(source_table.created_by),FALSE
,order_year,"EXTRACT(YEAR FROM TO_DATE(source_table.order_date, 'YYYY-MM-DD'))",FALSE
,order_month,"EXTRACT(MONTH FROM TO_DATE(source_table.order_date, 'YYYY-MM-DD'))",FALSE
priority_flag,is_priority,"CASE WHEN source_table.priority_flag = 'Y' THEN TRUE ELSE FALSE END",FALSE
